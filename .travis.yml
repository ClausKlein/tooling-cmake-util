language: cpp
sudo: false
cache:
  directories:
  - container
env:
- CMAKE_GENERATOR="Unix Makefiles" CMAKE_VERSION="latest" DEPLOY="1"
- CMAKE_GENERATOR="Ninja" CMAKE_VERSION="latest"
- CMAKE_GENERATOR="Unix Makefiles" CMAKE_VERSION="3.0"
- CMAKE_GENERATOR="Ninja" CMAKE_VERSION="3.0"
- CMAKE_GENERATOR="Unix Makefiles" CMAKE_VERSION="latest" COVERAGE="--use-cmake-coverage"
install:
- eval $(curl -LSs --retry 100 --connect-timeout 3 public-travis-scripts.polysquare.org/bootstrap.py
  | python /dev/stdin -d container -s setup/bii/setup.py -e bash -p /dev/stdout --cmake-version
  ${CMAKE_VERSION})
script:
- polysquare_run check/bii/check.py ${COVERAGE} --cmake-namespace psq --generator
  "${CMAKE_GENERATOR}" --block "smspillaz/tooling-cmake-util"
before_cache:
- polysquare_cleanup
after_success:
- polysquare_run coverage/bii/coverage.py
before_deploy:
- polysquare_run deploy/bii/deploy.py
deploy:
  provider: biicode
  skip_cleanup: true
  user:
    secure: mRq7RLxY4jPHCj2Fuq75pLrpVUm0Xmy5jOmRZh66+q8UNwaihPp7Q95eWv+3Eb0+WcDNCOtaPUMrn0pYq2W+LjDOM2+qBF2+vrdNBk/u+kmW+mxbJTJdWRTETn9JJK2C+djGADeMCCYrXple2p9lkSslnQ/S+KUJfy3yZX3G3og=
  password:
    secure: YN9FmcJhRLwinUtPBLwKadt6v5jxNEPPLBY4US7Ea9HmcOayRh+wH0+w1aPBemdLIIlz8KbvVgURHZL2FHLzk7uetx+AzSCLrTVB8a4G4A55bTV4bBgans3SPilnEKXIY8fH/BDbaR/w9K0h2iOFVJcjvq1K5VGq4ErtCVRayDk=
  on:
    repo: polysquare/tooling-cmake-util
    branch: master
    condition: ${DEPLOY} = 1
